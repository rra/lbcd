#
# Makefile.in for lbcd
#

CC     = @CC@

DEFS   = @DEFS@
LIBS   = @LIBS@
CFLAGS = @CFLAGS@

srcdir = @srcdir@
VPATH  = @srcdir@

SHELL  = /bin/sh

HDRS   = config.h lbcd.h protocol.h

LBSRC  = lbcd.c server.c
LBOBJ  = $(LBSRC:.c=.o)

SRCS   = kernel.c util.c get_user.c tmp_full.c
OBJS   = $(SRCS:.c=.o)

all: lbcd

.c.o: $(HDRS)
	$(CC) -c -I. -I$(srcdir) $(DEFS) $(CFLAGS) $<

lbcd: $(LBOBJ) $(OBJS)
	$(CC) $(LDFLAGS) -o $@ $(LBOBJ) $(OBJS) $(LIBS)

lbcdtest: $(OBJS) lbcdtest.o
	$(CC) $(LDFLAGS) -o $@ lbcdtest.o $(OBJS) $(LIBS)

lbcdtest.o: proto_server.c
	$(CC) -o $@ -DMAIN -c -I. -I$(srcdir) $(DEFS) $(CFLAGS) $<

clean:
	-rm -f *.o core lbcd lbcdtest

distclean: clean
	-rm -f Makefile config.log config.status config.cache config.h

#
# Dependencies
#
kernel.o: $(srcdir)/kernel.c \
	$(srcdir)/arch/aix.c $(srcdir)/arch/hpux10.c \
	$(srcdir)/arch/irix.c $(srcdir)/arch/linux.c \
	$(srcdir)/arch/osf.c $(srcdir)/arch/solaris.c
